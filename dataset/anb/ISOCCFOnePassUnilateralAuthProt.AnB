Protocol ISO_onepass_CCF:

Declarations:
    mac/2;

Types:
    Agent A,B;
    Number NA,Text1,Text2,tagISO_onepass_CCF1,tagISO_onepass_CCF2;
    Function mac;
    Symmetric_key skAB;

Knowledge:
    A: A, B, skAB;
    B: B, A, skAB;

Public:
    A,B;
Private:
    skAB;
Actions:
    [m1] A -> B (NA) : tagISO_onepass_CCF1 . NA . B . Text2 .
                  mac{tagISO_onepass_CCF2. NA. B. Text1}skAB . Text1;

Goals:
    B ->* A : NA. B . Text1;

ChannelKeys:

end