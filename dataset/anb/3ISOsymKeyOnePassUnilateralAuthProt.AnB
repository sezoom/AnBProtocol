Protocol: ISO_onepass_symm # Verified & Certified

# Note that this protocol has a trivial replay attack.  We thus
# specify only weak authentication as goal (not considering replay).
# The FP-module of OFMC currently does not handle injective
# authentication

Types:
       Agent A,B;
       Number NA,Text1,tagISOOTPS1;
       Mapping sk

Knowledge:
    A : A, B, sk(A,B), Text1;
    B : B, A, sk(A,B);

Actions:
    [msg1] A -> B (NA) : senc{NA . B . Text1}sk(A,B);

end