Protocol BilateralKeyExchange:

Declarations:
    aenc/2;
    senc/2;

Types:
    Agent 			A, B;
    Number 			nA, nB;
    Symmetric_key 	k;
    Mapping 		pk, sk
    Function 		h;

Knowledge:
    A: B, sk(A), h;
    B: A, sk(B), h;

Public:
    pk(A), pk(B);

Actions:
    [m1] B -> A (nB) 	: B.aenc{nB.B}pk(A);
    [m2] A -> B (nA, k) : aenc{h(nB).nA.A.k}pk(B);
    [m3] B -> A         : senc{h(nA)}k;

Goals:
    /* A authenticates B on K; */
    A *->* B: K;

end
