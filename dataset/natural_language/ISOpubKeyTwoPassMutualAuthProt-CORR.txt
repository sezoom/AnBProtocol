This protocol is a two-pass mutual entity-authentication mechanism using digital signatures, aligned with the ISO/IEC 9798-3 family. Each party proves possession of its private signing key while presenting a credential from a trusted authority that binds its identity to its public key. The design includes explicit, role-specific tags and a deployment-specific domain string to prevent reflection and cross-protocol misuse. Freshness is provided by independent nonces contributed by each side.  ￼

The exchange begins with the initiator sending two items in one flight. First is a credential from the trusted authority: a digitally signed statement over the initiator’s identifier and public key. Second is the initiator’s digital signature over a structured tuple that includes a role-specific tag, a freshly chosen nonce, the intended peer’s identifier, an application field (Text1), and a deployment domain tag. On receipt, the responder validates the authority’s signature using the authority’s public key, then verifies the initiator’s signature using the public key named in the credential. Successful checks authenticate the initiator and provide data-origin authentication for Text1 with freshness tied to the initiator’s nonce.  ￼

The responder returns a symmetric construction: a credential for its own public key from the same authority, and a signature over its fresh nonce, the initiator’s identifier, and its authenticated application field (Text3), again under a role-specific tag. The initiator verifies the authority’s credential and the responder’s signature. At this point, both sides have mutually authenticated each other and obtained data-origin authentication for their respective application fields (Text1 and Text3). Because nonces are not cross-bound in two passes, each side’s freshness is proved independently; the role-specific constants and explicit peer identifiers ensure directionality and block simple reflection attacks.  ￼

This mechanism does not provide confidentiality for Text1/Text3 and does not establish a session key; if secrecy or key establishment is needed, it should be composed with encryption or a KDF-based key agreement. The use of explicit identifiers/tags and careful binding of identities follows long-standing ISO/IEC 9798 guidance and aligns with repairs proposed in the formal analysis literature that strengthen the standard against reflection and context-confusion flaws.  ￼

Reference:
ISO/IEC 9798-3:2019, Information technology — Security techniques — Entity authentication — Part 3: Mechanisms using digital signature techniques (ten mechanisms; mutual authentication variants; object identifiers and role of a trusted third party).  ￼

Basin, Cremers, Meier. “Provably Repairing the ISO/IEC 9798 Standard for Entity Authentication,” POST 2012 / JCS 2013 (analysis and repairs, including domain-separating tags and identity binding to prevent reflection/UKS issues).  ￼