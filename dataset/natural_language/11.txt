Protocol Eleven defines an authenticated key–establishment exchange between two agents, A and B, using public-key encryption, digital signatures, and an exponential function over a public generator g(). Each agent X possesses a public key pk(X) and a corresponding private key sk(X). The values g()^na and g()^nb denote exponentiation of the public generator by the ephemeral secrets na and nb, respectively, in an appropriate cyclic group. Both agents share knowledge of g() and of each other’s public keys; A knows sk(A) and B knows sk(B).

The protocol is initiated when A generates an ephemeral exponent na and sends message 1 to B. In this message, A signs the triple (g()^na, A, pk(A)) using its private key sk(A), represented as aenc{ g()^na . A . pk(A) }sk(A), and appends its public key pk(A). This provides B with A’s ephemeral Diffie–Hellman value and an authenticated binding between that value, A’s identity, and A’s public key.

Upon receipt of message 1, B verifies A’s signature using pk(A) and chooses its own fresh exponent nb and a fresh nonce N. B then constructs message 2 as aenc{ N . g()^nb . B . pk(B) }pk(A), encrypting under A’s public key. This message conveys B’s Diffie–Hellman value g()^nb, the nonce N, and B’s identity and public key in a form that only A can decrypt. At this point, both parties possess each other’s authenticated public keys and ephemeral exponentials, but only A knows N.

After decrypting message 2, A recovers N and g()^nb and computes the shared Diffie–Hellman key g()^(na*nb), which it denotes for the A→B direction as g()^(nb*na) and uses as the symmetric key KAB. A then sends message 3, senc{ h(N) }(g()^(nb*na)), which is the hash of N encrypted under this derived key. This serves as implicit key confirmation: only a party that knows both na and nb (and hence g()^(na*nb)) can produce or verify this ciphertext.

Upon receiving message 3, B independently computes the shared key g()^(na*nb) from its knowledge of nb and the previously received g()^na. It uses this value as K(B,A) for the B→A direction. B decrypts message 3 with K(B,A), verifies that the recovered value equals h(N), and thereby confirms that A has derived the same Diffie–Hellman key and has correctly received N. B then sends message 4, aenc{ g()^(na*nb) }sk(B), which is a signature over the shared key using B’s private key. This final message provides explicit key confirmation and binds B’s identity to the established shared secret.

At the conclusion of Protocol Eleven, both agents A and B are intended to agree on the tuple (A, B, g()^na, g()^nb, g()^(na*nb), N) and to accept g()^(na*nb) as the bidirectional channel key (denoted K(A,B) and K(B,A)). The security goals are that A authenticates B and B authenticates A on this tuple, and that both the nonce N and the shared key g()^(na*nb) (equivalently g()^(nb*na)) remain secret between A and B and are not learned by any other party.