Protocol ISO_twopass_symm specifies a two-pass, symmetric-key–based unilateral authentication mechanism from A (the claimant) to B (the verifier), using a pre-shared symmetric key skAB. Both A and B know skAB; no other party is assumed to know it. The goal is for B to obtain data-origin authentication on the application value Text2 as coming from A in response to a fresh challenge, but the protocol does not establish any new keys or provide mutual authentication.

The protocol runs as follows. In message m1, B initiates the exchange by generating a fresh nonce NB and sending tagITS1 . NB to A. The tag tagITS1 identifies the specific mechanism or direction (B→A), while NB serves as a freshness challenge and must be recorded by B to detect replays.

Upon receiving m1, A responds with message m2. A computes a ciphertext
senc{ tagITS2 . NB . B . Text2 }skAB
and sends it to B. Here, A uses the shared key skAB to encrypt a structured tuple consisting of: a second mechanism tag tagITS2 (to distinguish the A→B direction and protocol variant), the received nonce NB, the verifier’s identity B, and the application data Text2 that A wishes B to accept as authentic. Because only A and B possess skAB, any valid decryption of this ciphertext implies that the sender knows the shared key. Including NB in the encrypted data ties the response to B’s current challenge, and including B prevents the same encrypted block from being safely reused towards a different verifier.

When B receives m2, it decrypts the ciphertext using skAB to obtain (tagITS2, NB, B, Text2). B verifies that the recovered nonce matches the challenge previously sent in m1, that the identity B is its own, and that tagITS2 corresponds to the expected protocol direction and variant. Provided NB is still considered fresh (according to B’s replay policy), B accepts Text2 as data-origin authentic from A in this run, and concludes that A was alive and knew skAB when constructing m2. The formal goal B ->* A : Text2 expresses that B non-injectively authenticates A on Text2: whenever B accepts Text2 using this protocol, there exists a corresponding execution in which A produced that value under the shared key and with the same challenge NB. The protocol does not derive or update any channel keys; it is purely a lightweight, symmetric-key, two-pass unilateral authentication and data-origin authentication mechanism.References: ISO/IEC 9798-2:2019 (entity authentication mechanisms using authenticated encryption, including two-pass unilateral variants); ISO/IEC 9798-1:2010 (general model and the requirement to use time-variant parameters).  ￼