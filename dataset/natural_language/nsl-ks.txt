Protocol NSLKeyServer specifies a public-key–based mutual authentication mechanism between two agents A and B, supported by a trusted server S that distributes certified public keys. Each principal X has a public–private key pair (pk(X), sk(X)). The public keys pk(A), pk(B), and pk(S) are assumed to be globally available; the private keys sk(A), sk(B), and sk(S) are known only to their respective owners. The server S acts as a certification authority that signs bindings between identities and public keys. The operator aenc{·}sk(S) is used as a signature by S (encrypt-with-private-key, verifiable with pk(S)), while aenc{·}pk(X) represents encryption to X, providing confidentiality under X’s public key. The protocol also uses a collection of explicit tags (tagNSLKeyServer1–tagNSLKeyServer7) to bind messages to their specific roles and directions and to prevent replay or reflection between different steps.

The protocol proceeds in two main phases: key discovery (A and B obtaining each other’s certified public keys from S) and a Needham–Schroeder–Lowe–style mutual authentication between A and B. In message m1, A contacts S with tagNSLKeyServer1 . A . B, indicating that it wishes to communicate with B and needs B’s certified public key. S responds in message m2 with aenc{ tagNSLKeyServer2 . B . pk(B) }sk(S), which is S’s signed certificate binding identity B to public key pk(B), tagged with tagNSLKeyServer2. A verifies this signature using pk(S) and thereby obtains an authenticated copy of pk(B).

A then initiates the authentication run with B. In message m3, A chooses a fresh nonce NA and sends aenc{ tagNSLKeyServer3 . NA . A }pk(B) to B. This ciphertext, protected under pk(B), contains the tag tagNSLKeyServer3, the nonce NA, and A’s identity. Only B can decrypt it using sk(B), and the structured contents ensure that the nonce is bound to the claimed sender A and to this specific step of the protocol.

Symmetrically, B may not initially trust that it has an authentic copy of A’s public key. In message m4, B therefore contacts S with tagNSLKeyServer4 . B . A, indicating its need for A’s key. S replies in message m5 with aenc{ tagNSLKeyServer5 . A . pk(A) }sk(S), a signed certificate binding A to pk(A) and tagged with tagNSLKeyServer5. B verifies this using pk(S) and obtains an authenticated pk(A).

Once B has both NA (from m3) and pk(A) (from m5), it continues the Needham–Schroeder–Lowe pattern. In message m6, B generates its own fresh nonce NB and sends aenc{ tagNSLKeyServer6 . NA . NB . B }pk(A) to A. This ciphertext, encrypted under pk(A), includes the tag tagNSLKeyServer6, the previously received NA, the new nonce NB, and B’s identity. The presence of NA proves that the responder has seen A’s first message and binds NB to the same run; the inclusion of B’s identity prevents simple role confusion.

Upon decrypting m6 using sk(A), A verifies that the NA inside matches its own nonce, thereby confirming that the message corresponds to the ongoing run and that the sender knows pk(A) and was able to decrypt m3. A then completes the mutual authentication by sending message m7: aenc{ tagNSLKeyServer7 . NB }pk(B). This is a ciphertext under pk(B) containing the tag tagNSLKeyServer7 and the nonce NB. When B decrypts m7 with sk(B) and verifies that the recovered NB matches the one it sent in m6, B concludes that A has decrypted m6, learned NB, and is therefore participating in the same protocol run.

The intended security goals are that A authenticates B on the nonce NA and B authenticates A on the nonce NB. Concretely, the goal A -> B : NA means that when B completes the protocol believing it has run with A, it agrees on the value NA that originated from A in the initiating message; the goal B -> A : NB means that when A completes the protocol, it agrees with B on the value NB that B generated in response. No explicit session key is derived or modeled as a channel key in this description, but the protocol is structured as a standard NSL-style public-key mutual authentication, augmented with an online key server S that provides signed public-key certificates for both parties.