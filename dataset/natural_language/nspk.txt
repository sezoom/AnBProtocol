Protocol nspk specifies a three-pass mutual authentication mechanism between two agents A and B using public-key encryption. Each agent X possesses a public–private key pair (pk(X), sk(X)). The public keys pk(A) and pk(B) are assumed to be known system-wide, while the private keys sk(A) and sk(B) are known only to their respective owners. The primitive aenc{ · }pk(X) denotes encryption under X’s public key, providing confidentiality so that only X, with sk(X), can recover the plaintext. The protocol uses nonces Na and Nb as freshness challenges, and explicit tags tagNSPK1, tagNSPK2, and tagNSPK3 to bind ciphertexts to specific steps in the exchange.

The protocol proceeds in three messages. In message nspk1, A initiates the run with B by generating a fresh nonce Na and sending
aenc{ tagNSPK1 . Na . A }pk(B)
to B. This ciphertext, encrypted under pk(B), carries the tag tagNSPK1, the fresh nonce Na, and A’s identity. Only B can decrypt this message, learn Na, and verify that it appears in the expected position tagged as tagNSPK1 with the claimed sender A. In message nspk2, B responds by generating its own fresh nonce Nb and sending
aenc{ tagNSPK2 . Na . Nb }pk(A)
to A. This binding of Na and Nb under pk(A) assures A that the responder has seen Na and introduces Nb as B’s contribution to freshness for this run. In message nspk3, A returns Nb to B in the form
aenc{ tagNSPK3 . Nb }pk(B),
again encrypted under pk(B) and marked with a distinct tag tagNSPK3. When B decrypts this final message and finds its own nonce Nb under the correct tag, it concludes that A has received and processed nspk2 and is participating in the same protocol run.

The intended security goals are that the nonces Na and Nb remain secret between A and B (they only ever appear inside public-key encryptions to the appropriate party) and that A authenticates B on the pair (Na, Nb). The goal A -> B : Na.Nb expresses that when A completes the protocol accepting the values Na and Nb, it believes it is sharing these nonces with B in a consistent run of the protocol. No session key or channel key is derived in this specification; the protocol serves purely as a public-key mutual challenge–response mechanism based on exchange and confirmation of the fresh nonces.