Protocol ISO_twopass_CCF specifies a two-pass, unilateral authentication mechanism from A (the claimant) to B (the verifier), based on a pre-shared symmetric key skAB and a message authentication code (MAC) function mac. Both A and B know the shared key skAB and the MAC algorithm; no new keys are established by this protocol. Its purpose is to allow B to authenticate that A currently knows skAB and to treat an application field Text2 as data-origin authentic from A, bound to this particular run of the protocol.

The protocol consists of two messages. In message m1, B initiates the exchange by choosing a fresh nonce NB and sending tagISOTCCF1 . NB to A. The tag tagISOTCCF1 identifies the protocol or mechanism variant, while NB serves as a challenge and freshness value. Upon receiving m1, A constructs message m2, which has the form mac{ NB . B . Text2 }skAB . NB . B . Text2. Here A computes a MAC under the shared key skAB over a structured tuple containing the received nonce NB, the verifier’s identity B, and the application data Text2 that A wants B to accept as authentic. A then sends the MAC together with the cleartext fields NB, B, and Text2, enabling B to recompute and verify the MAC.

On receipt of m2, B uses skAB to recompute mac{ NB . B . Text2 }skAB over the received NB, B, and Text2, and compares the result with the MAC provided by A. If the verification succeeds and NB is recognized as fresh (e.g., through replay checks), B concludes that the message was generated by a party that currently knows skAB and that Text2 is authentic and bound to this run, together with the specific verifier identity B and the challenge NB. The intended security goal, expressed as A *-> B : Text2, is that B non-injectively authenticates A on Text2: whenever B accepts Text2 via this protocol, there exists a corresponding run in which A produced the MAC over the same (NB, B, Text2) using the shared key. No mutual authentication or channel key derivation is provided; the mechanism strictly offers one-way data-origin authentication from A to B.
Reference

ISO/IEC 9798-4:1999, Information technology — Security techniques — Entity authentication — Part 4: Mechanisms using a cryptographic check function (scope, use of time-variant parameters, MAC-based one- and two-pass mechanisms).  ￼

ISO/IEC 9798-4:1999/Cor. 2:2012, Technical Corrigendum 2 (identifiers and constants for cryptographic check values / domain separation).  ￼

Basin, Cremers, Meier, “Provably Repairing the ISO/IEC 9798 Standard for Entity Authentication,” POST 2012 / JCS 2013 (analysis and recommended hardenings of the 9798-4 mechanisms).  ￼