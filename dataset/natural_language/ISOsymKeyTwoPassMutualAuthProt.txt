The mutual entity-authentication mechanism is two-pass protocol, built on a pre-shared symmetric key. Each side proves possession of the shared key by sending a single encrypted (and integrity-protected) tuple that also carries its own freshness value and an authenticated application field. The design matches the ISO/IEC 9798-2 class of symmetric-key mechanisms (2019 edition: “using authenticated encryption”), where time-variant parameters (nonces) enforce replay resistance and where protocol/role identifiers provide domain separation.  ￼

The exchange begins with the initiator sending one ciphertext under the shared key. The protected tuple is (tagITMS1, NA, B, Text1, tag): a role-specific tag (tagITMS1) marks message direction; NA is the initiator’s fresh nonce; B binds the intended peer and prevents reflection; Text1 is application data that the initiator wants the peer to accept as authentic; and tag is an additional domain-separation constant for this deployment. Using authenticated encryption (AEAD) ensures both confidentiality and integrity of all included fields. On receipt, the peer decrypts and verifies; success authenticates the initiator and Text1 with freshness (NA).  ￼

The responder returns a second ciphertext under the same key over (tagITMS2, NB, A, Text3). Here tagITMS2 is the opposite-role tag; NB is the responder’s fresh nonce; A binds the peer; and Text3 is the responder’s authenticated application field. After decryption and verification, the initiator learns the responder’s possession of the key in this run and accepts Text3 as fresh and authentic. Because each direction uses distinct tags and binds the peer identity inside the protected data, simple reflection and cross-protocol confusions are blocked—consistent with well-known repairs and guidance for the 9798 family. Note that in two passes the nonces are not cross-bound; each side’s freshness is proved independently.  ￼

Properties and limits. The mechanism provides mutual entity authentication; data-origin authentication for Text1 (to the responder) and for Text3 (to the initiator); replay resistance via NA/NB; and confidentiality/integrity for the protected fields (under AEAD). It does not establish a new session key or provide forward secrecy; if those are needed, compose it with a key-establishment step (e.g., ephemeral DH with a KDF) and bind the transcript to the derived keys. Implementations should generate nonces uniformly at random, enforce unambiguous serialization of tagged tuples, and use explicit role/domain identifiers as shown.  ￼

Reference
	•	ISO/IEC 9798-2:2019, IT Security techniques — Entity authentication — Part 2: Mechanisms using authenticated encryption (scope, time-variant parameters, unilateral and mutual symmetric-key mechanisms).  ￼
	•	Basin, Cremers, Meier, “Provably Repairing the ISO/IEC 9798 Standard for Entity Authentication,” POST 2012 / JCS 2013 (analysis and recommended hardenings such as role-specific constants and identity binding).  ￼