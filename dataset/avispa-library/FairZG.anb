
  S: Trusted Third Party (TTP) 
  C: Commitment = {M}_K
  L: Label = hash(M.K)

  A  -> B: fNRO.B.L.C.NRO           NRO  = {fNRO.B.L.C}_inv(Ka)
  A <-  B: fNRR.A.L.NRR             NRR  = {fNRR.A.L.C}_inv(Kb)
  A  -> S: fSUB.B.L.K.SubK          SubK = {fSUB.B.L.K}_inv(ka)
  A <-> S: fCON.A.B.L.K.ConK        ConK = {fCON.A.B.L.K}_inv(ks)
  B <-> S: fCON.A.B.L.K.ConK        ConK = {fCON.A.B.L.K}_inv(ks)
 