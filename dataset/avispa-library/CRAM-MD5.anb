Protocol CRAM-MD5:

Declarations:
    h/1;

Types:
	Agent 		  A, B;
	Number 		  nB, t;
	Symmetric_key k(A,B);
	Function	  h;

Knowledge:
    A : k(A,B);
    B : k(A,B);

Actions:
	A -> B        : A;
	B -> A (nB,t) : nB.t.B;
	A -> B        : h(k(A,B).t);

Goals:
    k(A,B) secret between A,B;
    B -> A : nB;

end
