Protocol TwoPartyRSA:

Declarations:
    inv/1;
    senc/2;

Knowledge:
    BC: pk(Kbc),sk(Kbc), p(Ks);
    S: pk(Kbc), pk(Ks), sk(ks);
    C: pk(Kbc), pk(Ks);

Actions:
    [m1] BC -> S (M, SM): M . aenc{M}(sk(Kbc));
    [m2] S -> BC (SSM): aenc{SM}(sk(Ks));
    [m3] BC -> C (M, SSM): M . aenc{aenc{SSM}(pk(Ks))}pk(Kbc);

end