
   res = F2(k(M); r)   where F2 hash
   CK =  F3(k(M); r)   where F3 one-way
   IK =  F4(k(M); r)   where F4 one-way
   Ka =  F5(k(M); r)   where F5 one-way
   AUTN = {seq}Ka; F1(k(M); seq; r)  where F1 hash

 M -> S : M
 S -> M : r; {seq}_Ka; F1(k(M); seq; r)

      from r M calculates KA, then seq, then checks if F1(k(M); seq; r) OK
      if yes, M increments his seq number and responds:

 M -> S : F2(k(M); r)
 