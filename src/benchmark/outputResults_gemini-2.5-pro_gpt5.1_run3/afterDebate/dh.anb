Protocol DIFFIE_HELLMAN:

Declarations:
    g/0;
    exp/2;
    senc/2;
    kdf/1;

Types:
    Agent A, B;
    Number x, y, n;
    Symmetric_key K;

Knowledge:
    A : A, B, g;
    B : A, B, g;

Public:
    A, B, g;

Private:

Actions:
    [step1] A -> B (x) : exp(g(), x);
    [step2] B -> A (y) : exp(g(), y);
    [step3] A -> B (n) : senc{ n }(kdf(exp(exp(g(), x), y)));

Goals:
    kdf(exp(exp(g(), x), y)) secret between A, B;
    B -> A : n;

ChannelKeys:
    K(A,B): kdf(exp(exp(g(), x), y));

end