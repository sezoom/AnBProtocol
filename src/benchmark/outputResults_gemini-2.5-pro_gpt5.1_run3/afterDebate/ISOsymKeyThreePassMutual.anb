Protocol ISO9798_2_3pass:

Declarations:
    senc/2;

Types:
    Agent A,B;
    Number NA,NB;
    Data tagITMS1,tagITMS2,tagITMS3,Text2,Text4;
    Symmetric_key KAB;

Knowledge:
    A : A, B, KAB, Text2;
    B : A, B, KAB, Text4;

Public:
    A, B;

Private:
    KAB;

Actions:
    /* Pass 1: Verifier (B) sends a challenge */
    [m1] B -> A (NB) : B . tagITMS1 . NB;

    /* Pass 2: Claimant (A) responds to the challenge */
    [m2] A -> B (NA) : senc{ tagITMS3 . NA . NB . B . Text2 }KAB;

    /* Pass 3: Verifier (B) completes the mutual authentication */
    [m3] B -> A      : senc{ tagITMS2 . NB . NA . Text4 }KAB;

Goals:
    /* Mutual authentication on the nonces */
    B -> A : NA . NB;
    A -> B : NA . NB;

    /* Data-origin authentication for payloads */
    B -> A : Text2;
    A -> B : Text4;

ChannelKeys:

end