Protocol DH-Explicit-KC:

Declarations:
    g/0;
    exp/2;
    kdf/1;
    aenc/2;
    senc/2;

Types:
    Agent A,B;
    Number x,y,n;
    Function kdf;
    Mapping exp

Knowledge:
    A : A, B, g();
    B : A, B, g();

Public:
    g();

Private:

Actions:
    [m1] A -> B (x) : exp(g(), x);
    [m2] B -> A (y) : exp(g(), y);
    [m3] A -> B (n) : aenc{ n }kdf(exp(exp(g(), y), x));

Goals:
    exp(g(), x*y) secret between A,B;
    B -> A : n;

ChannelKeys:
    K(A,B): kdf(exp(g(), x*y));

end