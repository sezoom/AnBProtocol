Protocol ITMS2:

Declarations:
    senc/2;

Types:
    Agent A,B;
    Number NA,NB,tagITMS1,tagITMS2,tag;
    Text Text1,Text3;
    Symmetric_key k;

Knowledge:
    A : A, B, k, tagITMS1, tagITMS2, tag, Text1;
    B : A, B, k, tagITMS1, tagITMS2, tag, Text3;

Public:

Private:
    k;

Actions:
    [m1] A -> B (NA) : senc{ tagITMS1 . NA . B . Text1 . tag }k;
    [m2] B -> A (NB) : senc{ tagITMS2 . NB . A . Text3 . tag }k;

Goals:
    B -> A : NA . Text1;
    A -> B : NB . Text3;
    NA . Text1 secret between A,B;
    NB . Text3 secret between A,B;

ChannelKeys:

end