Protocol ISO9798-3-MutualDS:

Declarations:
    aenc/2;
    sig/2;
    h/1;

Types:
    Agent A,B,S;
    Number NA,NB,tagA,tagB,Domain,Text1,Text3;
    Function h;
    Mapping pk,sk,cred

Knowledge:
    A : A, B, pk(A), pk(B), pk(S), cred(A), cred(B), sk(A), tagA, tagB, Domain, Text1;
    B : A, B, pk(A), pk(B), pk(S), cred(A), cred(B), sk(B), tagA, tagB, Domain, Text3;
    S : pk(S), sk(S);

Public:
    pk(A), pk(B), pk(S), cred(A), cred(B), tagA, tagB, Domain;

Private:
    sk(A), sk(B), sk(S);

Actions:
    [m1] A -> B (NA) :
        cred(A) .
        sig{ tagA . NA . B . Text1 . Domain }sk(A);

    [m2] B -> A (NB) :
        cred(B) .
        sig{ tagB . NB . A . Text3 . Domain }sk(B);

Goals:
    /* Mutual authentication and data-origin authentication for Text1 and Text3 */
    B -> A : sig{ tagA . NA . B . Text1 . Domain }sk(A);
    A -> B : sig{ tagB . NB . A . Text3 . Domain }sk(B);
    NA secret between A,B;
    NB secret between A,B;

ChannelKeys:

end