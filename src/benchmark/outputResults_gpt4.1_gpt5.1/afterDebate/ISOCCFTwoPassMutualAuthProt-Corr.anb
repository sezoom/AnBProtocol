Protocol ISOTMCCF2:

Declarations:
    f1/6;
    f2/5;

Types:
    Agent A,B;
    Number NA,NB,Text1,Text3,tag,tagISOTMCCF1,tagISOTMCCF2;
    Function f1,f2;
    Mapping sk;

Knowledge:
    A : A, B, sk(A,B), tagISOTMCCF1, tagISOTMCCF2, tag;
    B : A, B, sk(A,B), tagISOTMCCF1, tagISOTMCCF2, tag;
Public:

Private:
    sk(A,B);

Actions:
    [m1] A -> B (NA) : NA . B . Text1 . f1(tagISOTMCCF1, sk(A,B), NA, B, Text1, tag);
    [m2] B -> A (NB) : NB . A . Text3 . f2(tagISOTMCCF2, sk(A,B), NB, A, Text3);

Goals:
    B -> A : f2(tagISOTMCCF2, sk(A,B), NB, A, Text3);
    A -> B : f1(tagISOTMCCF1, sk(A,B), NA, B, Text1, tag);
ChannelKeys:
end