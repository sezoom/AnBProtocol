Protocol NonReversible:

Declarations:
    senc/2;
    f/2;
    sk/2;

Types:
    Agent A,B;
    Number NA,NB,tag1,tag2,tag6,tag7;
    Symmetric_key K;
    Mapping sk;

Knowledge:
    A : A, B, sk(A,B);
    B : A, B, sk(A,B);

Public:

Private:
    sk(A,B);

Actions:
    [m1] B -> A (NB) :
        B . senc{ tag1 . NB }sk(A,B);

    [m2] A -> B (NA,K) :
        A . senc{ tag2 . f(tag6, NB) . NA . A . K }sk(A,B);

    [m3] B -> A :
        senc{ tag7 . f(tag7, NA) }K;

Goals:
    /* B authenticates A on (NA, K, f(tag6, NB)) */
    B -> A : NA . K . f(tag6, NB);
    /* A authenticates B on (NA, K) */
    A -> B : NA . K;
    /* K secret between A,B */
    K secret between A,B;
    /* Assume: f is one-way in its second argument; NA not derivable from f(tag7, NA) */
ChannelKeys:

end