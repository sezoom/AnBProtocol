Protocol NSPK:

Declarations:
    senc/2;

Types:
    Agent A,B,S;
    Number IA,IB;
    Symmetric_key kA,kB,CK;

Knowledge:
    A : A, B, S, kA, IA;
    B : A, B, S, kB;
    S : A, B, S, kA, kB;

Public:

Private:
    kA, kB;

Actions:
    [n1] A -> S (IA) : A . B . IA;
    [n2] S -> A (CK) : senc{ IA . B . CK . senc{ CK . A }kB }kA;
    [n3] A -> B      : senc{ CK . A }kB;
    [n4] B -> A (IB) : senc{ IB }CK;
    [n5] A -> B      : senc{ IB }CK;

Goals:
    B -> A : CK;
    CK secret between A,B;

ChannelKeys:
    K(A,B): CK;
    K(B,A): CK;

end