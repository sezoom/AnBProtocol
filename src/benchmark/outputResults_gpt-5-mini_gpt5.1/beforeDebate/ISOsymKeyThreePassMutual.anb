Protocol ISO9798-3pass:

Declarations:
    senc/2;

Types:
    Agent A,B;
    Number NA,NB,tagITMS1,tagITMS2,tagITMS3,Text2,Text4;
    Symmetric_key KAB;

Knowledge:
    A : A, B, KAB;
    B : A, B, KAB;

Public:
    tagITMS1, tagITMS2, tagITMS3;

Private:
    KAB;

Actions:
    [step1] B -> A (NB) : tagITMS1 . NB ;
    [step2] A -> B (NA) : senc{ tagITMS3 . NA . NB . B . Text2 }KAB ;
    [step3] B -> A     : senc{ tagITMS2 . NB . NA . Text4 }KAB ;

Goals:
    B -> A : NA . NB . Text2;
    A -> B : NB . NA . Text4;
    Text2 secret between A,B;
    Text4 secret between A,B;

ChannelKeys:

end