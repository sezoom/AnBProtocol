Protocol NSPK:

Declarations:
    aenc/2;

Types:
    Agent A,B,AS;
    Number IA,IB;
    Mapping pk,sk

Knowledge:
    A : A, B, AS, pk(A), sk(A), pk(AS);
    B : A, B, AS, pk(B), sk(B), pk(AS);
    AS: AS, pk(AS), sk(AS), pk(A), pk(B);

Public:
    pk(A), pk(B), pk(AS);

Private:
    sk(A), sk(B), sk(AS);

Actions:
    [s1] A -> AS (IA) : A . B . IA;
    [s2] AS -> A      : aenc{ pk(B) . B . IA }sk(AS);
    [s3] A -> B  (IA) : aenc{ IA . A }pk(B);
    [s4] B -> AS (IB) : B . A . IB;
    [s5] AS -> B      : aenc{ pk(A) . A . IB }sk(AS);
    [s6] B -> A  (IB) : aenc{ IA . IB }pk(A);
    [s7] A -> B       : aenc{ IB }pk(B);

Goals:
    B -> A : IA;
    A -> B : IB;

ChannelKeys:

end