Protocol KerberosBasic:

Declarations:
    senc/2;
    sk/2;

Types:
    Agent A,B,G,S;
    Number N1,N2,T1,T2,T3,Payload;
    Symmetric_key KAG,KAS;
    Mapping sk;

Knowledge:
    A : A, B, G, S, sk(A,B);
    B : B, A, G, sk(A,B), sk(B,G);
    G : G, B, S, sk(B,G), sk(G,S);
    S : S, G, sk(G,S);
Public:

Private:
    sk(A,B), sk(B,G), sk(G,S);

Actions:
    [s1] A -> B (N1) : A . G . N1;
    [s2] B -> A (KAG,T1) : senc{ KAG . A . T1 }sk(B,G) . senc{ KAG . N1 . T1 . G }sk(A,B);
    [s3] A -> G (N2) : senc{ KAG . A . T1 }sk(B,G) . senc{ A . T1 }KAG . S . N2;
    [s4] G -> A (KAS,T2) : senc{ KAS . A . T2 }sk(G,S) . senc{ KAS . N2 . T2 . S }KAG;
    [s5] A -> S (T3) : senc{ KAS . A . T2 }sk(G,S) . senc{ A . T3 }KAS;
    [s6] S -> A : senc{ T3 }KAS . senc{ Payload }KAS;

Goals:
    S *->* A : Payload;
    KAG secret between A,B,G;
    KAS secret between A,G,S;
    Payload secret between A,G,S;

ChannelKeys:
    K(A,G): KAG;
    K(G,A): KAG;
    K(A,S): KAS;
    K(S,A): KAS;
end