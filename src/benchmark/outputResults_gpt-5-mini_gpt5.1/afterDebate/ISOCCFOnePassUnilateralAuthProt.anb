Protocol ISO9798-4_MAC_ClaimantToVerifier:

Declarations:
   mac/2;

Types:
    Agent A,B;
    Number NA, tagProt, tagMAC, Text1, Text2;
    Symmetric_key KAB;
    Mapping pk,sk

Knowledge:
    A : A, B, pk(A), sk(A), pk(B), KAB, tagProt, tagMAC, Text1, Text2;
    B : A, B, pk(B), sk(B), pk(A), KAB, tagProt, tagMAC;

Public:
    pk(A), pk(B), tagProt, tagMAC;

Private:
    sk(A), sk(B), KAB;

Actions:
    [step1] A -> B (NA) : tagProt . NA . B . Text2 . mac(tagMAC . NA . B . Text1, KAB) . NA . B . Text1;
    [step2] B -> A : Text1;

Goals:
    B -> A : Text1;
ChannelKeys:

end