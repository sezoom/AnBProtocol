Protocol Yahalom:

Declarations:
    senc/2;

Types:
    Agent Alice,Bob,S;
    Number NA,NB;
    Symmetric_key KAS,KBS,KAB;

Knowledge:
    Alice : Alice, Bob, KAS;
    Bob : Alice, Bob, KBS;
    S : Alice, Bob, KAS, KBS;
Public:

Private:
    KAS, KBS;

Actions:
    [step1] Alice -> Bob (NA) : Alice . NA ;
    [step2] Bob -> S (NB) : Bob . senc{ Alice . NA . NB }KBS ;
    [step3] S -> Alice (KAB) : senc{ Bob . KAB . NA . NB }KAS . senc{ Alice . KAB }KBS ;
    [step4] Alice -> Bob : senc{ Alice . KAB }KBS . senc{ NB }KAB ;

Goals:
    Alice -> Bob : KAB;
    Bob -> Alice : KAB;
    KAB secret between Alice,Bob;

ChannelKeys:
    K(Alice,Bob): KAB;
    K(Bob,Alice): KAB;

end