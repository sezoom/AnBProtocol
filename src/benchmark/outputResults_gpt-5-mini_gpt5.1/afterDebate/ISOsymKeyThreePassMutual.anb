Protocol ISO9798-3pass:

Declarations:
    senc/2;

Types:
    Agent Alice,Bob;
    Number NA,NB,tagITMS1,tagITMS2,tagITMS3,Text2,Text4;
    Symmetric_key KAB;

Knowledge:
    Alice : Alice, Bob, KAB;
    Bob   : Alice, Bob, KAB;

Public:
    tagITMS1, tagITMS2, tagITMS3;

Private:
    KAB;

Actions:
    [step1] Bob  -> Alice (NB) : tagITMS1 . NB ;
    [step2] Alice -> Bob (NA)  : senc{ tagITMS3 . NA . NB . Bob . Text2 }KAB ;
    [step3] Bob  -> Alice      : senc{ tagITMS2 . NB . NA . Text4 }KAB ;

Goals:
    Bob  -> Alice : NA . NB . Text2;
    Alice -> Bob  : NB . NA . Text4;
    Text2 secret between Alice,Bob;
    Text4 secret between Alice,Bob;

ChannelKeys:

end