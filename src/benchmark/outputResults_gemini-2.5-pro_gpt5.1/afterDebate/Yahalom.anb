Protocol Yahalom:

Declarations:
    senc/2;
    k/2;

Types:
    Agent A,B,S;
    Number Na,Nb;
    Symmetric_key Kab;

Knowledge:
    A : A, B, S, k(A,S);
    B : A, B, S, k(B,S);
    S : A, B, S, k(A,S), k(B,S);

Public:
    A, B, S;

Private:
    k(A,S), k(B,S);

Actions:
    [1] A -> B (Na) : A . Na;
    [2] B -> S (Nb) : B . senc{ A . Na . Nb }k(B,S);
    [3] S -> A (Kab) : senc{ B . Kab . Na . Nb }k(A,S) . senc{ A . Kab }k(B,S);
    [4] A -> B       : senc{ A . Kab }k(B,S) . senc{ Nb }Kab;

Goals:
    Kab secret between A,B;
    B -> A : Kab;
    A -> B : Kab;

ChannelKeys:
    K(A,B): Kab;
    K(B,A): Kab;

end