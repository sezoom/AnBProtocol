Protocol DenningSacco:

Declarations:
    senc/2;
    sk/2;

Types:
    Agent A,B,S;
    Number t, payload;
    Symmetric_key kAB;
    Mapping sk;

Knowledge:
    A : A, B, S, sk(A,S);
    B : B, A, S, sk(B,S);
    S : S, A, B, sk(A,S), sk(B,S);

Public:
    A, B, S;

Private:
    sk(A,S), sk(B,S);

Actions:
    [p1] A -> S             : A . B;
    [p2] S -> A (kAB, t)    : senc{ B . kAB . t . senc{ A . kAB . t }sk(B,S) }sk(A,S);
    [p3] A -> B             : senc{ A . kAB . t }sk(B,S);
    [p4] B -> A (payload)   : senc{ payload }kAB;

Goals:
    kAB secret between A,B;
    B ->* A : payload;

ChannelKeys:
    K(A,B): kAB;
    K(B,A): kAB;

end