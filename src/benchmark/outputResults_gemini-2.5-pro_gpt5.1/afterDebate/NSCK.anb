Protocol NSCK:

Declarations:
    senc/2;
    pre/2;
    sk/2;

Types:
    Agent A,B,S;
    Number NA,NB,tagnsck1,tagnsck2,tagnsck3,tagnsck4,tagnsck5,tagnsck6,tagnsck7;
    Symmetric_key KAB;
    Function pre;
    Mapping sk;

Knowledge:
    A : A, B, S, sk(A,S);
    B : A, B, S, sk(B,S);
    S : A, B, S, sk(A,S), sk(B,S);

Public:
    A, B, S;

Private:
    sk(A,S);
    sk(B,S);

Actions:
    [m1] A -> S (NA) :
        senc{ tagnsck1 . A . B . NA }sk(A,S);

    [m2] S -> A (KAB) :
        senc{ tagnsck2 . B . NA . KAB . senc{ tagnsck3 . A . B . KAB }sk(B,S) }sk(A,S);

    [m3] A -> B :
        senc{ tagnsck3 . A . B . KAB }sk(B,S);

    [m4] B -> A (NB) :
        senc{ tagnsck4 . NB }KAB;

    [m5] A -> B :
        senc{ tagnsck5 . pre(tagnsck7, NB) }KAB;

Goals:
    A -> B : KAB;
    B -> A : KAB;
    KAB secret between A,B;

ChannelKeys:
    K(A,B): KAB;
    K(B,A): KAB;

end