Protocol ISO9798-4-MAC:

Declarations:
    mac/2;

Types:
    Agent A,B;
    Number NA, tag1, tag2, Text1, Text2;
    Symmetric_key KAB;

Knowledge:
    A : A, B, KAB, Text2;
    B : A, B, KAB;

Public:
    A, B, tag1, tag2;

Private:
    KAB;

Actions:
    [step1] A -> B (NA) : tag1 . Text2 . NA . B . Text1 . mac{ tag2 . NA . B . Text1 }KAB;

Goals:
    /* B authenticates A is live and on the content of Text1 */
    B -> A : Text1;

ChannelKeys:

end