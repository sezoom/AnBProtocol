Protocol EDH-Confirm:

Declarations:
    g/0;
    kdf/1;
    senc/2;

Types:
    Agent A,B;
    Number x,y,n;
    Function kdf;

Knowledge:
    A : A, B, g();
    B : A, B, g();

Public:
    A, B, g();

Private:

Actions:
    [step1] A -> B (x) : g()^x;
    [step2] B -> A (y) : g()^y;
    [step3] A -> B (n) : senc{ n }kdf( g()^(x*y) );
    [step4] B -> A () : senc{ n }kdf( g()^(x*y) );

Goals:
    g()^(x*y) secret between A,B;
    B authenticates A on n;
    A authenticates B on n;

ChannelKeys:
    K(A,B): kdf(g()^(x*y));
    K(B,A): kdf(g()^(x*y));

end