Protocol ISO-9798-4-MAC-Unilateral:

Declarations:
    mac/2;

Types:
    Agent A,B;
    Number NB, IDp, Data;
    Function mac;
    Mapping sk;

Knowledge:
    A : A, B, sk(A,B), IDp, Data;
    B : A, B, sk(A,B), IDp;

Public:
    IDp;

Private:
    sk(A,B);

Actions:
    [step1] B -> A (NB) : IDp . NB;
    [step2] A -> B      : NB . B . Data . mac(sk(A,B), IDp . NB . B . Data);

Goals:
    B -> A : Data;

ChannelKeys:

end