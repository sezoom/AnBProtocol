Protocol ISO9798-4-MAC:

Declarations:
    mac/2;

Types:
    Agent A,B;
    Number NA, tag1, tag2, Text1, Text2;
    Function mac;
    Mapping k;

Knowledge:
    A : A, B, k(A,B);
    B : A, B, k(A,B);

Public:
    A, B, tag1, tag2;

Private:
    k(A,B);

Actions:
    [step1] A -> B (NA) : tag1 . Text2 . NA . B . Text1 . mac{ tag2 . NA . B . Text1 }k(A,B);

Goals:
    /* B authenticates A is live and on the content of Text1 */
    B -> A : Text1;

ChannelKeys:

end