Protocol ITS:

Declarations:
    senc/2;

Types:
    Agent A,B;
    Number NB, tagITS1, tagITS2, Text2;
    Symmetric_key KAB;

Knowledge:
    A : A, B, KAB;
    B : A, B, KAB;

Public:
    tagITS1, tagITS2;

Private:
    KAB;

Actions:
    [step1] B -> A (NB) : tagITS1 . NB ;
    [step2] A -> B (Text2) : senc{ tagITS2 . NB . B . Text2 }KAB ;

Goals:
    B -> A : Text2;
    Text2 secret between A,B;

end