Protocol ISO9798ThreePass:

Declarations:
    mac/2;

Types:
    Agent A,B;
    Number NA,NB,tag9798,Text2,Text4;
    Symmetric_key KAB;

Knowledge:
    A : KAB, Text2;
    B : KAB, Text4;

Public:
    tag9798;

Private:
    KAB;

Actions:
    [step1] B -> A (NB) : tag9798 . NB;
    [step2] A -> B (NA) : NA . NB . B . Text2 . mac(NA . NB . B . Text2 . tag9798, KAB);
    [step3] B -> A () : NB . NA . Text4 . mac(NB . NA . Text4 . tag9798, KAB);

Goals:
    A -> B : Text2;
    B -> A : Text4;

ChannelKeys:

end