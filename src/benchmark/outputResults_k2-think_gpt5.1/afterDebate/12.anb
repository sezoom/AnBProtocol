Protocol Twelve:

Declarations:
    senc/2; h/1;

Types:
    Agent Alice, Bob, C, M;
    Number N1, N2;
    Symmetric_key Kf, Ka, Kb, Km;
    Function h: Number -> Number;

Knowledge:
    Alice : Ka;
    Bob : Kb;
    C : Ka, Kb;
    M : Km;

Public:

Private:
    Ka, Kb, Km, Kf;

Actions:
    [step1] Alice -> C () : (Alice, Bob);
    [step2] C -> Alice (Kf) : (senc{Kf}Ka, senc{Kf}Kb);
    [step3] Alice -> Bob () : senc{Kf}Kb;
    [step4] Bob -> Alice (N2) : senc{N2}Kf;
    [step5] Alice -> Bob (N1) : senc{N1}Kf;
    [step6] Bob -> Alice () : senc{h(N1)}Kf;
Goals:
    weak auth of Bob to Alice;
    secrecy of Kf;
ChannelKeys:
end