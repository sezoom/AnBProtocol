Protocol AsymmetricAuth:

Declarations:
    sig/2;   % Signature: (message, private key) → signature
    aenc/2;  % Asymmetric encryption: (message, public key) → ciphertext
    h/3;     % Hash function: (term, term, term) → hash value

Types:
    Agent Alice, Bob;
    Number M, N;  % M is a message, N is a nonce
    Function h;   % Hash function
    Mapping pk: Agent → PubKey;  % Public key mapping: agent to public key
    Mapping sk: Agent → PrivKey; % Private key mapping: agent to private key

Knowledge:
    Alice : pk(Bob);  % Alice initially knows Bob's public key
    Bob : pk(Alice);  % Bob initially knows Alice's public key

Public:
    pk(Alice), pk(Bob);  % Public keys are publicly available

Private:
    sk(Alice) : Alice;  % Alice's private key is only known by Alice
    sk(Bob) : Bob;      % Bob's private key is only known by Bob

Actions:
    [step1] Alice -> Bob () : M, sig(M, sk(Alice));  % Alice sends message M with its signature
    [step2] Bob -> Alice (N) : Bob, pk(Bob), sig(N, sk(Bob));  % Bob sends identity, public key, and signed fresh nonce N
    [step3] Alice -> Bob () : aenc( (N, pk(Alice)), pk(Bob) );  % Alice encrypts (N, its public key) with Bob's public key and sends
    [step4] Bob -> Alice () : h(M, Bob, N);  % Bob sends hash of M, its identity, and N

Goals:
    Bob ->* Alice : Alice . M;  % Bob weakly authenticates Alice on (Alice, M)
    Alice ->* Bob : Bob . N;    % Alice weakly authenticates Bob on (Bob, N)

ChannelKeys:
    % No session keys established; channel uses public keys for encryption/signing
end