Protocol NSCK:

Declarations:
    senc/2;
    pre/2;

Types:
    Agent A,B,S;
    Number NA,NB,tagnsck1,tagnsck2,tagnsck3,tagnsck4,tagnsck5,tagnsck6,tagnsck7;
    Symmetric_key KAB;
    Function pre;
    Mapping pk, sk;

Knowledge:
    A : A, B, S, sk(A,S), pk(B);
    B : A, B, S, sk(B,S), pk(A);
    S : A, B, S, sk(A,S), sk(B,S);

Public:
    pk(A), pk(B);

Private:
    sk(A,S), sk(B,S);

Actions:
    [m1] A -> S (NA) : senc{ A . B . NA . tagnsck1 }sk(A,S);
    [m2] S -> A : senc{ NA . B . tagnsck2 . KAB . senc{ A . KAB . NA . B . tagnsck3 }sk(B,S) }sk(A,S);
    [m3] A -> B : senc{ A . KAB . NA . B . tagnsck3 }sk(B,S);
    [m4] B -> A (NB) : senc{ tagnsck4 . NB }KAB;
    [m5] A -> B : senc{ tagnsck5 . pre(tagnsck7, NB) }KAB;

Goals:
    KAB secret between A,B;
    B -> A : NB;
    A -> B : pre(tagnsck7, NB);

ChannelKeys:

end