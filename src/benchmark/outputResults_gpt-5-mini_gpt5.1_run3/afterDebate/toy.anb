Protocol KDFHandshake:

Declarations:
   senc/2;
   kdf/2;

Types:
    Agent A,B;
    Number NA,NB;
    Data ACK;
    Function kdf;

Knowledge:
    A : A, B;
    B : A, B;
Public:
    A, B;
Private:

Actions:
    [m1] A -> B (NA) : A . B . NA;
    [m2] B -> A (NB) : B . A . NB;
    [m3] A -> B : senc{ ACK . A . B . NA . NB }kdf(NA,NB);

Goals:
    B -> A : ACK . A . B . NA . NB;
    kdf(NA,NB) secret between A,B;

ChannelKeys:
    K(A,B): kdf(NA,NB);
end