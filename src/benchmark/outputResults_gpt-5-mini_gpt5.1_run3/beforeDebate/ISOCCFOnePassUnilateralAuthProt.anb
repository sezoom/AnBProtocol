Protocol ISO_onepass_CCF:

Declarations:
    f/5;

Types:
    Agent A,B;
    Number NA;
    Data tagISO_onepass_CCF1, tagISO_onepass_CCF2, Text1, Text2;
    Symmetric_key skAB;
    Function f

Knowledge:
    A : A, B, skAB, Text1, Text2, tagISO_onepass_CCF1, tagISO_onepass_CCF2;
    B : A, B, skAB, tagISO_onepass_CCF1, tagISO_onepass_CCF2;

Public:
    A, B, tagISO_onepass_CCF1, tagISO_onepass_CCF2;

Private:
    skAB;

Actions:
    /* Text2 is explicitly NOT covered by the check function and is unauthenticated auxiliary data */
    [m1] A -> B (NA) : tagISO_onepass_CCF1 . NA . B . Text2 . f(tagISO_onepass_CCF2, NA, B, Text1, skAB) . Text1;

Goals:
    /* B non-injectively authenticates A on (NA, B, Text1) */
    B ->* A : NA . B . Text1;

ChannelKeys:

end